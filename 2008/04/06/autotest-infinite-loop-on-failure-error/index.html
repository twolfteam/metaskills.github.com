<!DOCTYPE HTML>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="author" content="Ken Collins">
    <title>
      Autotest Infinite Loop On Failure & Error @MetaSkills.net
    </title>
    <link rel="alternate" type="application/atom+xml" href="http://feeds.feedburner.com/metaskills" title="MetaSkills.net">
    <link rel="author" href="mailto:ken@metaskills.net">
    <link rel="stylesheet" href="/resource/reset.css" type="text/css">
    <link rel="stylesheet" href="/resource/site.css" type="text/css">
    <link rel="shortcut icon" href="/favicon.png">
    <script src="/resource/zepto.js" type="text/javascript">
</script>
    <script src="/resource/site.js" type="text/javascript">
</script>
  </head>
  <body>
    <header id="mast">
      <div class="content">
        <section id="identity">
          <div id="avatar"></div>
          <div>
            MetaSkills.net
          </div>
          <div>
            Coding things under other things!
          </div>
        </section>
        <nav>
          <ul>
            <li>
              <a href="/" class="button" data-icon="H">Home</a>
            </li>
            <li>
              <a href="/pages/colophon.html" class="button" data-icon="i">Colophon</a>
            </li>
            <li>
              <a href="/pages/projects.html" class="button" data-icon="x">Projects</a>
            </li>
            <li>
              <a href="http://twitter.com/metaskills" class="button" data-icon="B">Follow</a>
            </li>
          </ul>
        </nav>
      </div>
    </header>
    <section id="page">
      <section id="content">
        <article id="post">
          <header>
            <time pubdate datetime="2008-04-06T00:00:00-04:00">
              <span class="day">06</span> <span class="month">Apr</span> <span class="year">2008</span>
            </time>
            <h1>
              true NOT!!
            </h1>
          </header>
          <p>
            I just had an issue pop up today that seemed to be an issue for a few others. It seemed that all of a sudden that my autotest was stuck
            in an infinite loop after a failure or error. At first I thought it was related to some additions to my <code>~/.autotest</code> file but
            after commenting out the whole lot of additions there, I realized it was something else. Here was my fix. Basically I think these errors
            are always related to a file that has changed during your test run. Now we just have to find out what that files are. Here are the steps
            I took to find out.
          </p>
          <h2>
            Step 1: Gather Changed FIle Info
          </h2>
          <p>
            To find out what files are changing. To do this add the -v option when you start autotest. This will cause it to run in verbose mode. Now
            after you have failed a test and YOU KNOW YOU DID NOT SAVE ANYTHING watch what happens below your listing of test, assertions, failures,
            and errors. There will be an array dumped that will contain the files change that have caused autotest to start another test cycle. In my
            case here is what I saw.
          </p>
          <div class="highlight">
            <pre>
<code class="text">1) Failure:
test_truth(BookmarkTest)
[test/unit/bookmark_test.rb:6
test/unit/bookmark_test.rb:5]:
&lt;false&gt; is not true.

1 tests, 1 assertions, 1 failures, 0 errors
[[&quot;config/uuid.state&quot;, Sun Apr 06 13:58:55 -0400 2008]]
Dunno! config/uuid.state
</code>
</pre>
          </div>
          <p>
            Ah ha... there it goes. I was using a UUID state file and it appears that file being written into the <code>config</code> directory is
            the culprit. By default autotest does not ignore that directory.
          </p>
          <h2>
            Step 2: Fix The Problem
          </h2>
          <p>
            We have two options here. You can either add an autotest exception in you <code>~/.autotest</code> file or you can bail out. My option is
            to bail out because I should not be adding a file at run time to the config directory. It would seem a better place would be the
            <code>tmp</code> directory. However if you think that adding an exception to your <code>~/.autotest</code> file would be more
            appropriate, here is the syntax:
          </p>
          <div class="highlight">
            <pre>
<code class="ruby"><span class="no">Autotest</span><span class="o">.</span><span class="n">add_hook</span> <span class=
"ss">:initialize</span> <span class="k">do</span> <span class="o">|</span><span class="n">autotest</span><span class="o">|</span>
  <span class="o">[</span><span class="s1">&#39;.svn&#39;</span><span class="p">,</span><span class="s1">&#39;.hg&#39;</span><span class=
"p">,</span><span class="s1">&#39;.git&#39;</span><span class="o">].</span><span class="n">each</span> <span class="p">{</span> <span class=
"o">|</span><span class="n">exception</span><span class="o">|</span> <span class="n">autotest</span><span class="o">.</span><span class=
"n">add_exception</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span> <span class="p">}</span>
<span class="k">end</span>
</code>
</pre>
          </div>
          <footer id="disqus_thread"></footer>
        </article>
      </section>
      <nav>
        <div>
          <a href="http://www.youtube.com/watch?v=8pBTK-pdMP0">Society for coding things on top of other things!</a>
        </div>
        <h3>
          Categories
        </h3>
        <ul>
          <li>
            <a href="/categories/heuristics.html">Heuristics</a>
          </li>
          <li>
            <a href="/categories/workflow.html">Workflow</a>
          </li>
          <li>
            <a href="/categories/apple-os.html">Apple/OS</a>
          </li>
          <li>
            <a href="/categories/database.html">Database</a>
          </li>
          <li>
            <a href="/categories/lifestyle.html">Lifestyle</a>
          </li>
          <li>
            <a href="/categories/miscellaneous.html">Miscellaneous</a>
          </li>
          <li>
            <a href="/categories/ruby-rails.html">Ruby/Rails</a>
          </li>
          <li>
            <a href="/categories/javascript.html">JavaScript</a>
          </li>
          <li>
            <a href="/categories/tools.html">Tools</a>
          </li>
        </ul>
      </nav>
    </section>
    <footer id="foot">
      <section id="footer">
        <section id="recentposts">
          <h3>
            Recent Posts
          </h3>
          <article>
            <h4>
              Bind jQuery Event Handlers To This Object With CoffeeScript
            </h4>
            <p>
              <a href="/2011/05/22/bind-jquery-event-handlers-to-this-object-with-coffeescript">Friends have told me that rich domain objects are
              seldom wielded when using jQuery to enhance behavior on web pages. I myself have always loved JavaScript as a rich dynamic...</a>
            </p>
          </article>
          <article>
            <h4>
              The Browser Is Dead?
            </h4>
            <p>
              <a href="/2011/05/21/the-browser-is-dead">This twitter post by Dave Thomas sparked an interesting back and forth with DHH on how Rails
              3.1 could be more opinionated towards web development for the browser. A short...</a>
            </p>
          </article>
          <article>
            <h4>
              Use Compass Sass Framework Files With The Rails 3.1 Asset Pipeline
            </h4>
            <p>
              <a href="/2011/05/18/use-compass-sass-framework-files-with-the-rails-3.1-asset-pipeline">The Sprockets 2 gem along with the Tilt gem
              make it really easy to write JavaScript or CSS using any templating language you desire. The rails defaults are CoffeeScript and...</a>
            </p>
          </article>
          <aside id="powered">
            <span>Powered by <a href="http://github.com/henrik/jekyll">Jekyll</a> and <a href="http://disqus.com">Disqus</a>. Check out <a href=
            "https://github.com/metaskills/metaskills.net">the code</a>.</span><br>
            <span>&copy; 2006-2011 Ken Collins. All rights reserved.</span>
          </aside>
          <aside id="html5_badge">
            <a href="http://www.w3.org/html/logo/"></a>
          </aside>
        </section>
        <section id="badges">
          <ul>
            <li>
              <a id="badge_js" href="https://developer.mozilla.org/en/JavaScript" title='JavaScript'>JavaScript</a>
            </li>
            <li>
              <a id="badge_ios" href="http://developer.apple.com/"></a>
            </li>
            <li>
              <a id="badge_railscore" href="http://contributors.rubyonrails.org/contributors/ken-collins/commits"></a>
            </li>
            <li>
              <a id="badge_pragalumni" href="http://alumni.pragmaticstudio.com/users/128"></a>
            </li>
            <li>
              <a id="badge_linkedin" href="http://www.linkedin.com/in/metaskills"></a>
            </li>
            <li>
              <a id="badge_slideshare" href="http://www.slideshare.net/metaskills"></a>
            </li>
            <li>
              <a id="badge_757rb" href="http://757rb.org/"></a>
            </li>
          </ul>
        </section>
        <section id="blogroll">
          <h3>
            Blogroll
          </h3>
          <ul>
            <li>
              <a href="http://ryan.mcgeary.org/">Ryan McGeary</a>
            </li>
            <li>
              <a href="http://www.linkedin.com/in/imbriaco">Mark Imbriaco</a>
            </li>
            <li>
              <a href="http://mwhuss.com/">Marshall Huss</a>
            </li>
            <li>
              <a href="http://fun3d.larc.nasa.gov/">Bil Kleb</a>
            </li>
            <li>
              <a href="http://www.buzzwordcompliant.net/">Mike Buckbee</a>
            </li>
            <li>
              <a href="http://www.candescence.org/">Geoff Parsons</a>
            </li>
            <li>
              <a href="http://www.wearetitans.net/">Brennan Dunn</a>
            </li>
            <li>
              <a href="http://evan.tiggerpalace.com/">Evan Light</a>
            </li>
            <li>
              <a href="http://techiferous.com/">Wyatt Greene</a>
            </li>
            <li>
              <a href="http://www.engineyard.com/blog/author/wayneseguin/">Wayne E. Sequin</a>
            </li>
          </ul>
        </section>
      </section>
    </footer>
  </body>
</html>
